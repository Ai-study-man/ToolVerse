# ðŸš€ Supabase å®Œå…¨æ–°æ‰‹æŒ‡å— - 5åˆ†é’Ÿå®Œæˆé…ç½®

## ðŸ“º è§†é¢‘æ•™ç¨‹å¼æŒ‡å—

### æ­¥éª¤ 1ï¸âƒ£: æ³¨å†Œ Supabaseï¼ˆ2åˆ†é’Ÿï¼‰

1. **æ‰“å¼€æµè§ˆå™¨**ï¼Œè®¿é—®ï¼šhttps://supabase.com
   
2. **ç‚¹å‡»å³ä¸Šè§’ç»¿è‰²æŒ‰é’®** "Start your project"

3. **é€‰æ‹©æ³¨å†Œæ–¹å¼**ï¼ˆæŽ¨èGitHubï¼‰
   - ç‚¹å‡» "Sign up with GitHub"
   - æˆ–è€…ç”¨é‚®ç®±æ³¨å†Œä¹Ÿå¯ä»¥

4. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç™»å½•åŽï¼Œç‚¹å‡» "New Project"
   - å¦‚æžœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œéœ€è¦å…ˆåˆ›å»º Organizationï¼ˆç»„ç»‡ï¼‰
   - Organization name: éšä¾¿å¡«ï¼Œæ¯”å¦‚ "my-projects"

### æ­¥éª¤ 2ï¸âƒ£: é…ç½®é¡¹ç›®ï¼ˆ1åˆ†é’Ÿï¼‰

å¡«å†™é¡¹ç›®ä¿¡æ¯ï¼š
```
é¡¹ç›®åç§°: toolverse-reviews  (æˆ–è€…ä½ å–œæ¬¢çš„åå­—)
æ•°æ®åº“å¯†ç : åˆ›å»ºä¸€ä¸ªå¼ºå¯†ç ï¼æ¯”å¦‚: MyStrongPass123!
åœ°åŒº: Northeast Asia (Singapore)  [é€‰æ‹©ç¦»ä¸­å›½æœ€è¿‘çš„]
å®šä»·: é€‰æ‹© "Free" å…è´¹ç‰ˆ
```

ç‚¹å‡» **"Create new project"**ï¼Œç­‰å¾…1-2åˆ†é’Ÿé¡¹ç›®åˆ›å»ºå®Œæˆã€‚

### æ­¥éª¤ 3ï¸âƒ£: èŽ·å–è¿žæŽ¥ä¿¡æ¯ï¼ˆ30ç§’ï¼‰

é¡¹ç›®åˆ›å»ºå®ŒæˆåŽï¼š

1. **åœ¨å·¦ä¾§èœå•æ‰¾åˆ° "Settings"**
2. **ç‚¹å‡» "API" é€‰é¡¹å¡**
3. **ä½ ä¼šçœ‹åˆ°è¿™äº›ä¿¡æ¯**ï¼š

```
Project URL: https://abcdefghijk.supabase.co
anon public: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3M...
service_role: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3M...
```

**ðŸ“‹ å¤åˆ¶è¿™ä¸‰ä¸ªå€¼ï¼**ï¼ˆç‚¹å‡»å³ä¾§çš„å¤åˆ¶æŒ‰é’®ï¼‰

### æ­¥éª¤ 4ï¸âƒ£: é…ç½®æœ¬åœ°çŽ¯å¢ƒå˜é‡ï¼ˆ30ç§’ï¼‰

1. **æ‰“å¼€ä½ çš„ä»£ç ç¼–è¾‘å™¨**ï¼ˆVS Codeï¼‰

2. **æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `.env.local` æ–‡ä»¶**
   - å¦‚æžœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å‘½åä¸º `.env.local`
   - æ³¨æ„ï¼šæ–‡ä»¶åå‰é¢æœ‰ä¸ªç‚¹ `.`

3. **ç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼Œæ›¿æ¢ä¸ºä½ çš„çœŸå®žä¿¡æ¯**ï¼š

```bash
# Supabase é…ç½® - æ›¿æ¢ä¸ºä½ çš„çœŸå®žä¿¡æ¯
NEXT_PUBLIC_SUPABASE_URL=https://ä½ çš„é¡¹ç›®ID.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=ä½ çš„anon_publicå¯†é’¥
SUPABASE_SERVICE_ROLE_KEY=ä½ çš„service_roleå¯†é’¥

# å…¶ä»–çŽ°æœ‰é…ç½®ä¿æŒä¸å˜...
NEXT_PUBLIC_GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
# ... å…¶ä»–é…ç½®
```

**é‡è¦æç¤º**ï¼š
- ä¸è¦åœ¨å¯†é’¥å‰åŽåŠ å¼•å·
- ç¡®ä¿æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼
- ä¿å­˜æ–‡ä»¶

### æ­¥éª¤ 5ï¸âƒ£: åˆ›å»ºæ•°æ®åº“è¡¨ï¼ˆ1åˆ†é’Ÿï¼‰

1. **å›žåˆ° Supabase æŽ§åˆ¶å°**

2. **åœ¨å·¦ä¾§èœå•æ‰¾åˆ° "SQL Editor"**

3. **ç‚¹å‡» "New Query"** åˆ›å»ºæ–°æŸ¥è¯¢

4. **å¤åˆ¶ç²˜è´´å®Œæ•´SQLä»£ç **ï¼š

```sql
-- å®Œæ•´çš„è¯„è®ºç³»ç»Ÿæ•°æ®åº“ä»£ç 
-- åˆ›å»ºç”¨æˆ·è¯„è®ºå’Œè¯„åˆ†è¡¨
CREATE TABLE IF NOT EXISTS reviews (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    tool_id TEXT NOT NULL,
    user_nickname VARCHAR(50) NOT NULL,
    user_email VARCHAR(255) NOT NULL,
    
    -- ä¸‰ä¸ªè¯„åˆ†ç»´åº¦ (1-5æ˜Ÿ)
    experience_rating INTEGER NOT NULL CHECK (experience_rating >= 1 AND experience_rating <= 5),
    functionality_rating INTEGER NOT NULL CHECK (functionality_rating >= 1 AND functionality_rating <= 5),
    value_rating INTEGER NOT NULL CHECK (value_rating >= 1 AND value_rating <= 5),
    
    -- è¯„è®ºå†…å®¹
    comment TEXT NOT NULL CHECK (char_length(comment) <= 200),
    use_case TEXT, -- ä½¿ç”¨åœºæ™¯æè¿°ï¼ˆå¯é€‰ï¼‰
    
    -- å®¡æ ¸çŠ¶æ€
    status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected')),
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    approved_at TIMESTAMP WITH TIME ZONE,
    
    -- é˜²æ­¢é‡å¤è¯„è®º
    CONSTRAINT unique_user_tool_review UNIQUE(tool_id, user_email)
);

-- åˆ›å»ºç´¢å¼•ä»¥ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
CREATE INDEX IF NOT EXISTS idx_reviews_tool_id ON reviews(tool_id);
CREATE INDEX IF NOT EXISTS idx_reviews_status ON reviews(status);
CREATE INDEX IF NOT EXISTS idx_reviews_created_at ON reviews(created_at DESC);

-- åˆ›å»ºç»Ÿè®¡è§†å›¾
CREATE VIEW IF NOT EXISTS review_stats AS
SELECT 
    tool_id,
    COUNT(*) as total_reviews,
    ROUND(AVG(experience_rating)::numeric, 1) as avg_experience_rating,
    ROUND(AVG(functionality_rating)::numeric, 1) as avg_functionality_rating, 
    ROUND(AVG(value_rating)::numeric, 1) as avg_value_rating,
    ROUND(AVG((experience_rating + functionality_rating + value_rating)::numeric / 3), 1) as overall_avg_rating
FROM reviews 
WHERE status = 'approved'
GROUP BY tool_id;

-- åˆ›å»ºæ›´æ–°æ—¶é—´è§¦å‘å™¨
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_reviews_updated_at 
    BEFORE UPDATE ON reviews 
    FOR EACH ROW 
    EXECUTE FUNCTION update_updated_at_column();

-- å¯ç”¨è¡Œçº§å®‰å…¨
ALTER TABLE reviews ENABLE ROW LEVEL SECURITY;

-- å…è®¸æ‰€æœ‰äººæŸ¥çœ‹å·²å®¡æ ¸çš„è¯„è®º
CREATE POLICY "Anyone can view approved reviews" ON reviews
    FOR SELECT USING (status = 'approved');

-- å…è®¸ä»»ä½•äººæäº¤è¯„è®ºï¼ˆä½†çŠ¶æ€ä¸ºpendingï¼‰
CREATE POLICY "Anyone can insert reviews" ON reviews
    FOR INSERT WITH CHECK (status = 'pending');

-- æ’å…¥ç¤ºä¾‹æ•°æ®
INSERT INTO reviews (tool_id, user_nickname, user_email, experience_rating, functionality_rating, value_rating, comment, use_case, status, approved_at) VALUES
('chatgpt', 'æµ‹è¯•ç”¨æˆ·', 'test1@example.com', 5, 5, 4, 'ChatGPTéžå¸¸å¥½ç”¨ï¼Œå›žç­”å‡†ç¡®ï¼Œç•Œé¢å‹å¥½ã€‚', 'ç”¨äºŽå†™ä»£ç å’Œæ–‡æ¡£ï¼Œæ•ˆçŽ‡å¤§å¹…æå‡', 'approved', CURRENT_TIMESTAMP),
('claude', 'AIä¸“å®¶', 'test2@example.com', 4, 5, 4, 'Claudeåœ¨é•¿æ–‡æœ¬ç†è§£æ–¹é¢è¡¨çŽ°å‡ºè‰²ã€‚', 'å¤æ‚é—®é¢˜åˆ†æžå’Œå­¦æœ¯å†™ä½œ', 'approved', CURRENT_TIMESTAMP),
('midjourney', 'è®¾è®¡å¸ˆ', 'test3@example.com', 5, 4, 3, 'AIç»˜å›¾è´¨é‡å¾ˆé«˜ï¼Œä½†ä»·æ ¼ç¨è´µã€‚', 'Logoè®¾è®¡å’Œåˆ›æ„æµ·æŠ¥åˆ¶ä½œ', 'approved', CURRENT_TIMESTAMP);
```

5. **ç‚¹å‡»å³ä¸‹è§’çš„ "RUN" æŒ‰é’®**ï¼ˆæˆ–æŒ‰ Ctrl+Enterï¼‰

6. **çœ‹åˆ° "Success" æ¶ˆæ¯å°±æˆåŠŸäº†ï¼**

### æ­¥éª¤ 6ï¸âƒ£: éªŒè¯é…ç½®ï¼ˆ30ç§’ï¼‰

1. **å›žåˆ°ä½ çš„ä»£ç ç¼–è¾‘å™¨**

2. **è¿è¡ŒçŽ¯å¢ƒæ£€æŸ¥**ï¼š
```bash
node scripts/check-env.js
```

3. **åº”è¯¥çœ‹åˆ°æ‰€æœ‰ âœ… ç»¿è‰²å‹¾å·**

4. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**ï¼š
```bash
npm run dev
```

5. **è®¿é—®æµ‹è¯•é¡µé¢**ï¼š
   - æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000/database-test
   - åº”è¯¥çœ‹åˆ°"ðŸŽ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼"

## ðŸŽ‰ å®Œæˆï¼ä½ çš„è¯„è®ºç³»ç»ŸçŽ°åœ¨å¯ä»¥ä½¿ç”¨äº†ï¼

### æµ‹è¯•è¯„è®ºåŠŸèƒ½ï¼š

1. **è®¿é—®ä»»æ„å·¥å…·é¡µé¢**ï¼šhttp://localhost:3000/tools
2. **ç‚¹å‡»ä»»æ„å·¥å…·è¿›å…¥è¯¦æƒ…é¡µ**
3. **æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œç‚¹å‡»"å†™è¯„è®º"**
4. **å¡«å†™å¹¶æäº¤è¯„è®º**

### å®¡æ ¸è¯„è®ºï¼š

1. **å›žåˆ°SupabaseæŽ§åˆ¶å°**
2. **ç‚¹å‡»å·¦ä¾§ "Table Editor"**
3. **é€‰æ‹© "reviews" è¡¨**
4. **æ‰¾åˆ°åˆšæäº¤çš„è¯„è®ºï¼ŒåŒå‡» status å­—æ®µ**
5. **æ”¹ä¸º "approved"ï¼ŒæŒ‰ Enter ä¿å­˜**
6. **åˆ·æ–°ç½‘ç«™ï¼Œè¯„è®ºå°±ä¼šæ˜¾ç¤ºäº†ï¼**

---

## ðŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆï¼š

**âŒ "æ‰¾ä¸åˆ°æ¨¡å—"**
- é‡å¯å¼€å‘æœåŠ¡å™¨ï¼š`Ctrl+C` ç„¶åŽ `npm run dev`

**âŒ "æƒé™è¢«æ‹’ç»"**
- æ£€æŸ¥çŽ¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®å¤åˆ¶
- ç¡®ä¿æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼æˆ–å¼•å·

**âŒ "è¡¨ä¸å­˜åœ¨"**
- é‡æ–°åœ¨Supabase SQLç¼–è¾‘å™¨ä¸­æ‰§è¡ŒSQLä»£ç 

**âœ… ä¸€åˆ‡æ­£å¸¸**
- æ­å–œï¼ä½ çš„è¯„è®ºç³»ç»Ÿå·²ç»å®Œå…¨å¯ä»¥ä½¿ç”¨äº†ï¼

---

## ðŸ’¡ å°è´´å£«

1. **æ•°æ®åº“å¯†ç å¾ˆé‡è¦**ï¼šä¸€å®šè¦è®°ä½ä½ è®¾ç½®çš„æ•°æ®åº“å¯†ç 
2. **å…è´¹é¢åº¦**ï¼šSupabaseå…è´¹ç‰ˆæ¯æœˆæœ‰å……è¶³çš„é¢åº¦ä¾›ä¸ªäººé¡¹ç›®ä½¿ç”¨
3. **å®‰å…¨æ€§**ï¼šä½ çš„service_roleå¯†é’¥å¾ˆé‡è¦ï¼Œä¸è¦åˆ†äº«ç»™åˆ«äºº
4. **å¤‡ä»½**ï¼šå¯ä»¥å®šæœŸå¯¼å‡ºæ•°æ®åº“ä½œä¸ºå¤‡ä»½

çŽ°åœ¨ä½ å·²ç»æ˜¯Supabaseä¸“å®¶äº†ï¼ðŸŽ“
